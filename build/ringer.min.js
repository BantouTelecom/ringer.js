(function(){var e=/\D/g,t=function(){return window.ATT?window.ATT.phoneNumber.parse:function(t){return t.replace(e,"").toString()}}(),n=function(e,n){var r=n||{},i;this.registerPhoneHandlers(e),this.config={ringtone:"https://js.att.io/sounds/ringtone.wav",ringbackTone:"https://js.att.io/sounds/calling.wav",ringtones:{},ringbackTones:{},delay:20},this.sounds={};for(i in r)this.config[i]=r[i];for(i in this.config.ringtones)this.loadFile(this.config.ringtones[i],t(i),this.config.delay);for(i in this.config.ringbackTones)this.loadFile(this.config.ringbackTones[i],t(i),this.config.delay);this.loadFile(this.config.ringtone,"ringtone",this.config.delay),this.loadFile(this.config.ringbackTone,"ringbackTone",this.config.delay)};n.prototype.registerPhoneHandlers=function(e){var t=this;e.on("calling",function(e){t.ringback(e)}),e.on("incomingCall",function(e,n){t.ring(n)}),e.on("callBegin",function(){t.stopAll()}),e.on("callEnd",function(){t.stopAll()})},n.prototype.loadFile=function(e,t){var n=this;setTimeout(function(){var t=new Audio;t.src=e,t.loop,t.addEventListener("ended",function(){t.currentTime=0,t.play()},!1),t.load(),n.sounds[e]=t},t||0)},n.prototype.play=function(e){var t=this.sounds[e];t&&t.readyState==4&&(t.currentTime=0,t.play())},n.prototype.stop=function(e){var t=this.sounds[e];t&&t.readyState==4&&(t.pause(),t.currentTime=0)},n.prototype.getRing=function(e){return this.config.ringtones[t(e)]||this.config.ringtone},n.prototype.getRingback=function(e){return this.config.ringbackTones[t(e)]||this.config.ringbackTone},n.prototype.stopRing=function(e){this.stop(this.getRing(e))},n.prototype.stopRingback=function(e){this.stop(this.getRingback(e))},n.prototype.ring=function(e){return this.play(this.getRing(e))},n.prototype.ringback=function(e){return this.play(this.getRingback(e))},n.prototype.stopAll=function(){for(var e in this.sounds)this.stop(e)},typeof exports!="undefined"?module.exports=n:window.Ringer=n})()